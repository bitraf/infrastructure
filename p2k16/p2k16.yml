---
- hosts:
    - p2k16
    - p2k16-staging
  vars_files:
    - ../vars/bitraf_passwords.yml
    - ../vars/postfix.yml
    - ../vars/users.yml
  roles:
    - network
    - packages
    - bitraf-base
    - lusers
    - superusers
    - postgresql-server-base
    - postfix-satellite
    - p2k16
  tasks:
    - name: PostgreSQL WAL-E
      import_role:
        name: postgresql-wal-e
      tags: postgresql-wal-e
      vars:
        pwe_major: 10
        pwe_instance: main

    - name: Unattended upgrades
      import_role: name=unattended-upgrades
      tags: unattended-upgrades
